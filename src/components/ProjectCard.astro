---
import { Github, ExternalLink, Pin } from "lucide-react";
import type { Project } from "../data/projects";
import {
	Card,
	CardContent,
	CardFooter,
	CardHeader,
	CardTitle,
	CardDescription,
} from "@/components/ui/card";
import { Badge } from "@/components/ui/badge";
import { Button } from "@/components/ui/button";
import { cn } from "@/lib/utils";

interface Props {
	project: Project;
}

const { project } = Astro.props as Props;
const languagesToShow = project.languages.slice(0, 3);
const moreLanguages = Math.max(0, project.languages.length - 3);
---

<a
	href={`/projects/${project.slug}`}
	class="block h-full group focus:outline-none"
	data-project-card
	data-pinned={project.pinned ? "true" : "false"}
>
	<Card
		className={cn(
			"h-full flex flex-col overflow-hidden border-border/50 bg-card/50 backdrop-blur-sm transition-all duration-300 hover:shadow-lg hover:-translate-y-1 dark:hover:shadow-primary/5 hover:border-primary/20",
			project.pinned && "border-primary/30 dark:border-primary/20"
		)}
	>
		<CardHeader className="p-6 pb-2 space-y-2.5 relative">
			{
				project.pinned && (
					<div class="absolute top-0 right-0 p-3">
						<Pin className="w-4 h-4 text-primary rotate-45" />
					</div>
				)
			}
			<CardTitle
				className="text-xl font-bold tracking-tight group-hover:text-primary transition-colors"
			>
				{project.title}
			</CardTitle>
			<CardDescription className="line-clamp-3 leading-relaxed">
				{project.description}
			</CardDescription>
		</CardHeader>

		<CardContent className="p-6 py-2 flex-1">
			<div class="flex flex-wrap gap-1.5 mt-2">
				{
					languagesToShow.map((lang) => (
						<Badge
							variant="secondary"
							className="text-[10px] font-medium bg-secondary/50 hover:bg-secondary/70 transition-colors"
						>
							{lang}
						</Badge>
					))
				}
				{
					moreLanguages > 0 && (
						<Badge variant="outline" className="text-[10px] font-medium">
							+{moreLanguages}
						</Badge>
					)
				}
			</div>
		</CardContent>

		<CardFooter className="p-6 pt-2 mt-auto flex items-center gap-3">
			{
				project.live_website_url && (
					<Button
						variant="default"
						size="sm"
						className="h-8 text-xs gap-1.5 shadow-sm"
						data-live-link
						data-url={project.live_website_url}
					>
						<ExternalLink className="w-3.5 h-3.5" />
						Live Demo
					</Button>
				)
			}
			<Button
				variant="outline"
				size="sm"
				className="h-8 text-xs gap-1.5 bg-background/50 backdrop-blur-sm"
				data-github-link
				data-url={project.github_link}
			>
				<Github className="w-3.5 h-3.5" />
				Source
			</Button>
		</CardFooter>
	</Card>
</a>
