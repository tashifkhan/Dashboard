---
import Layout from "../layouts/Layout.astro";
import ResumeComponent from "../components/Resume.astro";
import { ArrowLeft } from "lucide-react";
---

<Layout title="Resume - Tashif Ahmad Khan">
	<div
		class="relative min-h-screen bg-gradient-to-b from-gray-50 to-white dark:from-gray-950 dark:to-gray-900 py-6 sm:py-8 text-gray-900 dark:text-gray-100"
	>
		<div
			class="pointer-events-none absolute inset-0 [mask-image:radial-gradient(80%_60%_at_50%_0%,black,transparent)]"
		>
			<div
				class="h-32 bg-gradient-to-b from-orange-200/40 to-transparent dark:from-orange-900/20"
			>
			</div>
		</div>
		<div class="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
			<div class="mb-6 sm:mb-8">
				<a
					href="/"
					class="inline-flex items-center text-orange-600 dark:text-orange-400 hover:text-orange-800 dark:hover:text-orange-300 mb-4 transition-colors text-sm sm:text-base"
				>
					<ArrowLeft size={18} className="mr-2" />
					Back to Home
				</a>
				<h1
					class="text-3xl sm:text-4xl font-bold tracking-tight bg-gradient-to-r from-gray-900 to-gray-600 dark:from-white dark:to-gray-300 bg-clip-text text-transparent mb-2"
				>
					Resume
				</h1>
				<p class="text-gray-600 dark:text-gray-300 text-sm sm:text-base">
					Professional experience and achievements
				</p>
			</div>

			<div
				class="rounded-2xl border border-gray-200/60 dark:border-gray-800/60 bg-white/70 dark:bg-gray-900/50 backdrop-blur p-4 sm:p-6"
			>
				<ResumeComponent />
			</div>
			<div id="print-resume-container" style="display:none;"></div>
			<script>
				document.addEventListener("DOMContentLoaded", () => {
					const btn = document.querySelector("[data-download-resume]");
					if (btn) {
						btn.addEventListener("click", async () => {
							try {
								const html2pdf = (await import("html2pdf.js")).default;
								const container = document.getElementById(
									"print-resume-container"
								);
								if (!container) {
									console.error("Container not found");
									return;
								}
								const res = await fetch("/print-resume");
								const html = await res.text();
								container.innerHTML = html;
								const resumeContent =
									container.querySelector("body") || container;
								await html2pdf()
									.set({
										margin: 0,
										filename: "Tashif_Ahmad_Khan_Resume.pdf",
										image: { type: "jpeg", quality: 0.98 },
										html2canvas: { scale: 2, useCORS: true },
										jsPDF: {
											unit: "in",
											format: "a4",
											orientation: "portrait",
										},
									})
									.from(resumeContent)
									.save();
								container.innerHTML = "";
							} catch (error) {
								console.error("Error generating PDF:", error);
								alert("Failed to generate PDF. Please try again.");
							}
						});
					}
				});
			</script>
		</div>
	</div>
</Layout>
