---
import Layout from "../layouts/Layout.astro";
import ProjectFilters from "../components/ProjectFilters.tsx";
import { starLists } from "../data/starLists";
import BlogFilters from "../components/BlogFilters";
import BlogCard from "../components/BlogCard.astro";
import LeetCodeStats from "../components/LeetCodeStats.astro";
import GitHubStats from "../components/GitHubStats.astro";
import LeetCodeContests from "../components/LeetCodeContests.astro";
import LeetCodeBadges from "../components/LeetCodeBadges.astro";
import Resume from "../components/Resume.astro";
import {
	Github,
	Twitter,
	Linkedin,
	Mail,
	Code2,
	FolderOpen,
	BookOpen,
	Users,
	ExternalLink,
	Globe,
	FileText,
	ArrowUp,
	Trophy,
	BarChart3,
	ChevronRight,
} from "lucide-react";
import { allProjects, type Project } from "../data/projects";
import { leetCodeData } from "../data/leetcode";
import { githubStats } from "../data/github";
import ProjectCard from "../components/ProjectCard.astro";
import { Card, CardContent } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Textarea } from "@/components/ui/textarea";
import { Label } from "@/components/ui/label";
import { Badge } from "@/components/ui/badge";

import ThemeToggle from "@/components/ThemeToggle";

const projects: Project[] = allProjects;

// Fetch blog posts from external API
type RemotePost = {
	title: string;
	date: string; // ISO date
	author: string;
	socials: string[];
	tags: string[];
	excerpt: string;
	slug: string;
	wordCount?: number;
	readingTimeMinutes?: number;
};

let blogPosts: RemotePost[] = [];
try {
	const res = await fetch("https://blog.tashif.codes/api/posts.json");
	if (res.ok) {
		blogPosts = (await res.json()) as RemotePost[];
		// Sort posts by date desc to ensure the latest is featured first
		blogPosts.sort(
			(a, b) => new Date(b.date).getTime() - new Date(a.date).getTime()
		);
	} else {
		console.error(
			"Failed to fetch remote blog posts:",
			res.status,
			res.statusText
		);
	}
} catch (err) {
	console.error("Error fetching remote blog posts:", err);
}
const { profile } = leetCodeData;
const { stats, stars } = githubStats;

const numProjects = projects.length;
const numBlogPosts = blogPosts.length;
const totalCommits = stats?.totalCommits ?? 0;
const totalSolved = leetCodeData?.stats?.totalSolved ?? 0;
const liveProjectCount = projects.filter((p) => p.live_website_url).length;
const latestBlogDate = blogPosts[0]?.date ? new Date(blogPosts[0].date) : null;

// Use tags from remote posts as categories for filtering
const blogCategories = [
	...new Set(
		blogPosts.flatMap((post) => (Array.isArray(post.tags) ? post.tags : []))
	),
];

// Aggregate metrics from the remote posts (new API includes wordCount & readingTimeMinutes)
const totalBlogWords = blogPosts.reduce(
	(sum, p) => sum + (p.wordCount || 0),
	0
);
const avgReadingMinutes = blogPosts.length
	? Math.round(
			blogPosts.reduce((s, p) => s + (p.readingTimeMinutes || 0), 0) /
				blogPosts.length
		)
	: 0;

const socials = [
	{ icon: Github, link: "https://github.com/tashifkhan", label: "GitHub" },
	{ icon: Globe, link: "https://portfolio.tashif.codes", label: "Portfolio" },
	{
		icon: Linkedin,
		link: "https://www.linkedin.com/in/tashifkhan/",
		label: "LinkedIn",
	},
	{
		icon: Twitter,
		link: "https://twitter.com/khan_tashif_",
		label: "Twitter",
	},
	{ icon: Mail, link: "mailto:tashif@duck.com", label: "Email" },
];
---

<Layout title="Tashif Ahmad Khan - Personal Dashboard">
	<div
		class="relative min-h-screen bg-background text-gray-900 dark:text-gray-100 transition-colors duration-300 font-sans scroll-smooth"
	>
		<div
			class="pointer-events-none absolute inset-0 [mask-image:radial-gradient(80%_60%_at_50%_0%,black,transparent)]"
		>
			<div
				class="h-40 bg-gradient-to-b from-orange-200/40 to-transparent dark:from-orange-900/20"
			>
			</div>
		</div>
		<!-- Header -->
		<header
			class="sticky top-0 z-40 backdrop-blur supports-[backdrop-filter]:bg-white/70 dark:supports-[backdrop-filter]:bg-gray-900/60 bg-white/80 dark:bg-gray-900/70 border-b border-gray-200/60 dark:border-gray-800/60 shadow-sm"
		>
			<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3 sm:py-4">
				<div
					class="flex flex-col sm:flex-row justify-between items-center gap-4"
				>
					<div class="flex items-center space-x-5 overflow-visible">
						<span
							class="p-[2px] rounded-full bg-gradient-to-tr from-primary via-primary/80 to-primary/60"
						>
							<span
								class="block rounded-full bg-white dark:bg-gray-900 p-[2px]"
							>
								<img
									src="https://avatars.githubusercontent.com/u/75897907?v=4"
									alt="Tashif Ahmad Khan"
									class="w-14 h-14 sm:w-16 sm:h-16 rounded-full object-cover block"
								/>
							</span>
						</span>
						<div>
							<h1
								class="text-2xl sm:text-3xl font-bold tracking-tight bg-gradient-to-r from-gray-900 to-gray-600 dark:from-white dark:to-gray-300 bg-clip-text text-transparent"
							>
								Tashif Ahmad Khan
							</h1>
							<p class="text-gray-600 dark:text-gray-300 text-sm">
								{profile.realName || "Software Developer"}
							</p>
						</div>
					</div>
					<div class="flex items-center space-x-1.5 sm:space-x-2">
						{
							socials.map((social) => (
								<Button
									variant="ghost"
									size="icon"
									asChild
									className="rounded-full"
								>
									<a
										href={social.link}
										target="_blank"
										rel="noopener noreferrer"
										aria-label={social.label}
									>
										<social.icon size={20} />
									</a>
								</Button>
							))
						}
						<ThemeToggle client:load />
					</div>
				</div>
			</div>
		</header>

		<!-- Navigation (Styled as Shadcn Tabs) -->
		<nav
			class="sticky top-[56px] sm:top-[64px] z-30 backdrop-blur supports-[backdrop-filter]:bg-white/70 dark:supports-[backdrop-filter]:bg-gray-900/60 bg-white/80 dark:bg-gray-900/70 border-b border-gray-200/60 dark:border-gray-800/60 transition-colors duration-300 overflow-x-auto font-sans no-scrollbar"
		>
			<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-2">
				<div
					class="inline-flex h-10 items-center justify-start rounded-md bg-muted p-1 text-muted-foreground w-full sm:w-auto overflow-x-auto no-scrollbar"
					style="overflow-x: auto !important;"
				>
					<button
						id="projects-tab"
						class="inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm hover:text-foreground shrink-0"
						data-state="active"
					>
						<FolderOpen size={16} className="mr-2" />
						Projects
					</button>
					<button
						id="resume-tab"
						class="inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm hover:text-foreground shrink-0"
						data-state="inactive"
					>
						<FileText size={16} className="mr-2" />
						About
					</button>
					<button
						id="blog-tab"
						class="inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm hover:text-foreground shrink-0"
						data-state="inactive"
					>
						<BookOpen size={16} className="mr-2" />
						Blog
					</button>
					<button
						id="github-tab"
						class="inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm hover:text-foreground shrink-0"
						data-state="inactive"
					>
						<Github size={16} className="mr-2" />
						GitHub
					</button>
					<button
						id="leetcode-tab"
						class="inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm hover:text-foreground shrink-0"
						data-state="inactive"
					>
						<Code2 size={16} className="mr-2" />
						LeetCode
					</button>
					<button
						id="community-tab"
						class="inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm hover:text-foreground shrink-0"
						data-state="inactive"
					>
						<Users size={16} className="mr-2" />
						Connect
					</button>
				</div>
			</div>
		</nav>

		<!-- Main Content -->
		<main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8">
			<!-- Welcome restore pill (shown when banner is hidden) -->
			<div id="welcome-restore" class="mb-4 hidden">
				<Button
					id="welcome-restore-btn"
					variant="outline"
					size="sm"
					className="rounded-full bg-white/60 dark:bg-gray-900/60"
					aria-controls="welcome-banner"
				>
					<span class="inline-block h-2 w-2 rounded-full bg-orange-500 mr-2"
					></span>
					Show welcome
				</Button>
			</div>

			<!-- Minimal Welcome Banner -->
			<Card
				id="welcome-banner"
				className="mb-8 bg-white/70 dark:bg-gray-900/60 backdrop-blur border-gray-200/60 dark:border-gray-800/60"
			>
				<CardContent className="p-4 sm:p-5">
					<div class="flex items-start justify-between gap-3">
						<div class="min-w-0">
							<h2
								class="text-base sm:text-lg font-semibold tracking-tight mb-1"
							>
								Welcome
							</h2>
							<p class="text-gray-600 dark:text-gray-300 text-sm">
								Quick snapshot across Projects, Blog, GitHub and LeetCode.
							</p>
						</div>
						<Button
							id="welcome-dismiss"
							variant="ghost"
							size="icon"
							className="h-8 w-8"
							aria-label="Dismiss welcome"
							aria-controls="welcome-banner"
						>
							<span aria-hidden="true">×</span>
						</Button>
					</div>
					<div class="mt-3 flex flex-wrap items-center gap-2">
						<!-- Compact stats pills -->
						<Badge
							variant="outline"
							className="bg-white/60 dark:bg-gray-900/60 font-normal"
						>
							<Code2 size={14} className="text-primary mr-1.5" />
							{numProjects} Projects
						</Badge>
						<Badge
							variant="outline"
							className="bg-white/60 dark:bg-gray-900/60 font-normal"
						>
							<BookOpen size={14} className="text-primary mr-1.5" />
							{numBlogPosts} Posts
						</Badge>
						<Badge
							variant="outline"
							className="bg-white/60 dark:bg-gray-900/60 font-normal"
						>
							<Github size={14} className="text-primary mr-1.5" />
							{totalCommits} Commits
						</Badge>
						<Badge
							variant="outline"
							className="bg-white/60 dark:bg-gray-900/60 font-normal"
						>
							<Code2 size={14} className="text-primary mr-1.5" />
							{totalSolved} Solved
						</Badge>

						<!-- Tiny actions -->
						<span class="ml-auto inline-flex items-center gap-1">
							<Button
								variant="outline"
								size="icon"
								className="h-8 w-8 bg-primary/10 dark:bg-primary/10 border-primary/20 dark:border-primary/20 hover:bg-primary/20 dark:hover:bg-primary/20 text-primary dark:text-primary"
								asChild
							>
								<a href="/resume" aria-label="View resume">
									<FileText size={16} />
								</a>
							</Button>
						</span>
					</div>
				</CardContent>
			</Card>

			<!-- Projects Section -->
			<div id="projects-section">
				<!-- Header Card - Visible on all screen sizes -->
				<Card
					className="relative border-border/60 bg-card/70 backdrop-blur mb-6"
				>
					<CardContent className="p-4 sm:p-5">
						<!-- Mobile Layout -->
						<div class="flex flex-col gap-3 md:hidden">
							<div class="flex items-center gap-3">
								<div
									class="p-2 rounded-xl bg-primary/10 text-primary ring-1 ring-primary/20"
								>
									<Code2 className="w-4 h-4" />
								</div>
								<h2 class="text-lg font-semibold text-foreground">
									Projects Showcase
								</h2>
							</div>
							<div class="flex flex-wrap gap-2 items-center">
								<Badge variant="secondary" className="text-xs">
									{numProjects} Total
								</Badge>
								<Badge variant="secondary" className="text-xs">
									{liveProjectCount} Live
								</Badge>
								<a
									href="/projects/stats"
									class="ml-auto inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-semibold rounded-lg bg-chart-1/15 text-chart-1 border border-chart-1/30 hover:bg-chart-1/25 hover:border-chart-1/50 transition-all"
								>
									<BarChart3 className="w-3.5 h-3.5" />
									Stats
								</a>
							</div>
						</div>
						<!-- Desktop Layout -->
						<div class="hidden md:flex items-center gap-4">
							<div
								class="p-2.5 rounded-xl bg-primary/10 text-primary ring-1 ring-primary/20"
							>
								<Code2 className="w-5 h-5" />
							</div>
							<div class="flex-1">
								<h2 class="text-xl font-semibold text-foreground mb-1">
									Projects Showcase
								</h2>
								<p class="text-sm text-muted-foreground">
									A curated collection of things I've built – open source
									libraries, experiments and product work.
								</p>
							</div>
							<div class="flex flex-wrap gap-2 items-center">
								<Badge variant="secondary" className="text-xs">
									{numProjects} Total
								</Badge>
								<Badge variant="secondary" className="text-xs">
									{liveProjectCount} Live
								</Badge>
								<a
									href="/projects/stats"
									class="ml-2 inline-flex items-center gap-1.5 px-4 py-1.5 text-xs font-semibold rounded-lg bg-chart-1/15 text-chart-1 border border-chart-1/30 hover:bg-chart-1/25 hover:border-chart-1/50 shadow-sm hover:shadow-chart-1/20 transition-all"
								>
									<BarChart3 className="w-3.5 h-3.5" />
									View Stats
								</a>
							</div>
						</div>
					</CardContent>
				</Card>

				<ProjectFilters client:load starLists={starLists} />
				<div
					class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 auto-rows-fr"
				>
					{
						projects.map((project) => (
							<div
								class="h-full"
								data-project-item-card
								data-has-live-link={Boolean(project.live_website_url)}
							>
								<ProjectCard project={project} />
							</div>
						))
					}
				</div>
			</div>

			<!-- Resume Section -->
			<div id="resume-section" class="hidden">
				<Resume />
			</div>

			<!-- Blog Section -->
			<div id="blog-section" class="hidden relative">
				<!-- Header Card -->
				<Card
					className="relative border-gray-200/60 dark:border-gray-800/60 bg-white/70 dark:bg-gray-900/50 backdrop-blur mb-6 hidden md:block"
				>
					<CardContent className="p-5 flex items-center gap-4">
						<div
							class="p-2.5 rounded-xl bg-primary/10 dark:bg-primary/10 text-primary dark:text-primary ring-1 ring-primary/20"
						>
							<BookOpen className="w-5 h-5" />
						</div>
						<div class="flex-1">
							<h2
								class="text-xl font-semibold text-gray-900 dark:text-white mb-1"
							>
								Latest Articles
							</h2>
							<p class="text-sm text-gray-600 dark:text-gray-400">
								Insights, tutorials & engineering notes – concise thoughts on
								building modern web experiences.
							</p>
						</div>
						<div class="flex flex-wrap gap-2">
							<Badge variant="secondary" className="text-xs">
								{numBlogPosts} Posts
							</Badge>
							<Badge variant="secondary" className="text-xs">
								{avgReadingMinutes} min read
							</Badge>
						</div>
					</CardContent>
				</Card>
				<BlogFilters client:load categories={blogCategories} />
				{
					blogPosts.length > 0 ? (
						<div class="space-y-10">
							<section class="mb-4">
								<BlogCard post={blogPosts[0]} variant="featured" index={0} />
							</section>
							<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5">
								{blogPosts.slice(1).map((post, idx) => (
									<BlogCard post={post} variant="default" index={idx + 1} />
								))}
							</div>
							<div class="pt-10">
								<Card className="w-full text-center border-0 shadow-lg bg-gradient-to-br from-primary/5 via-transparent to-primary/5 dark:from-primary/10 dark:via-transparent dark:to-primary/10">
									<CardContent className="p-8 sm:p-10 space-y-6 relative overflow-hidden">
										<div class="absolute inset-0 bg-grid-slate-200/50 dark:bg-grid-slate-800/50 [mask-image:linear-gradient(to_bottom,transparent,black,transparent)] pointer-events-none" />
										<div class="space-y-3 relative z-10">
											<h3 class="text-2xl font-bold text-gray-900 dark:text-white tracking-tight">
												Want to read more?
											</h3>
											<p class="text-gray-600 dark:text-gray-300 max-w-lg mx-auto leading-relaxed">
												Explore the full archive for in‑depth guides &
												architecture notes. New posts are published regularly.
											</p>
										</div>
										<div class="flex justify-center">
											<Button
												size="lg"
												className="relative z-10 rounded-full px-8 bg-primary text-primary-foreground hover:bg-primary/90 shadow-md transition-all hover:scale-105"
												asChild
											>
												<a
													href="https://blog.tashif.codes"
													target="_blank"
													rel="noopener noreferrer"
													class="flex items-center gap-2 text-primary-foreground opacity-70 hover:text-primary transition-colors"
												>
													Visit Full Blog
													<ExternalLink size={16} className="ml-2" />
												</a>
											</Button>
										</div>
									</CardContent>
								</Card>
							</div>
						</div>
					) : (
						<div class="text-center py-14">
							<div class="inline-flex flex-col items-center gap-4 p-8 rounded-2xl bg-white/70 dark:bg-gray-900/50 backdrop-blur border border-gray-200/60 dark:border-gray-700/60">
								<div class="w-14 h-14 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center">
									<ExternalLink className="w-7 h-7 text-gray-400 dark:text-gray-500" />
								</div>
								<h3 class="text-base font-semibold text-gray-900 dark:text-white">
									No posts available
								</h3>
								<p class="text-gray-600 dark:text-gray-300 text-sm max-w-md">
									Unable to load blog posts from the external API. Try again
									later or visit the blog directly.
								</p>
								<Button
									variant="link"
									className="text-primary dark:text-primary"
									asChild
								>
									<a
										href="https://blog.tashif.codes"
										target="_blank"
										rel="noopener noreferrer"
									>
										Visit blog <ExternalLink size={15} className="ml-1" />
									</a>
								</Button>
							</div>
						</div>
					)
				}
			</div>

			<!-- GitHub Section -->
			<div id="github-section" class="hidden space-y-8">
				<!-- Header Card (GitHub) -->
				<Card className="relative border-border/60 bg-card/70 backdrop-blur">
					<CardContent className="p-4 sm:p-5">
						<!-- Mobile Layout -->
						<div class="flex flex-col gap-3 md:hidden">
							<div class="flex items-center gap-3">
								<div
									class="p-2 rounded-xl bg-chart-3/15 text-chart-3 ring-1 ring-chart-3/30"
								>
									<Github className="w-4 h-4" />
								</div>
								<h2 class="text-lg font-semibold text-foreground">
									GitHub Profile
								</h2>
							</div>
							<div class="flex flex-wrap gap-2 items-center">
								<Badge variant="secondary" className="text-xs">
									{totalCommits} Commits
								</Badge>
								<a
									href="https://github.com/tashifkhan"
									target="_blank"
									rel="noopener noreferrer"
									class="inline-flex items-center gap-1 px-2.5 py-1 text-xs font-medium rounded-lg bg-secondary text-secondary-foreground hover:bg-secondary/80 transition-colors"
								>
									<ExternalLink className="w-3 h-3" />
									Profile
								</a>
								<a
									href="/github"
									class="ml-auto inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-semibold rounded-lg bg-chart-3/15 text-chart-3 border border-chart-3/30 hover:bg-chart-3/25 hover:border-chart-3/50 transition-all"
								>
									<ChevronRight className="w-3.5 h-3.5" />
									Full Page
								</a>
							</div>
						</div>
						<!-- Desktop Layout -->
						<div class="hidden md:flex items-center gap-4">
							<div
								class="p-2.5 rounded-xl bg-chart-3/15 text-chart-3 ring-1 ring-chart-3/30"
							>
								<Github className="w-5 h-5" />
							</div>
							<div class="flex-1">
								<h2 class="text-xl font-semibold text-foreground mb-1">
									GitHub Profile
								</h2>
								<p class="text-sm text-muted-foreground">
									Open source velocity, activity and language distribution.
								</p>
							</div>
							<div class="flex flex-wrap gap-2 items-center">
								<Badge variant="secondary" className="text-xs">
									{totalCommits} Commits
								</Badge>
								<a
									href="https://github.com/tashifkhan"
									target="_blank"
									rel="noopener noreferrer"
									class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium bg-secondary text-secondary-foreground hover:bg-secondary/80 transition-colors"
								>
									External Profile <ExternalLink size={12} />
								</a>
								<a
									href="/github"
									class="ml-2 inline-flex items-center gap-1.5 px-4 py-1.5 text-xs font-semibold rounded-lg bg-chart-3/15 text-chart-3 border border-chart-3/30 hover:bg-chart-3/25 hover:border-chart-3/50 shadow-sm hover:shadow-chart-3/20 transition-all"
								>
									<ChevronRight className="w-3.5 h-3.5" />
									Full Page
								</a>
							</div>
						</div>
					</CardContent>
				</Card>

				<!-- Stats + Graph / Languages etc. -->
				<GitHubStats />

				<!-- Callout: View Starred Lists in Projects -->
				<Card
					className="border-primary/50 dark:border-primary/40 bg-primary/5 dark:bg-primary/10 backdrop-blur"
				>
					<CardContent
						className="p-5 flex flex-col sm:flex-row items-start sm:items-center gap-4"
					>
						<div class="flex items-center gap-3">
							<BarChart3 className="w-5 h-5 text-primary dark:text-primary" />
							<h3
								class="text-sm font-semibold text-primary dark:text-primary tracking-tight"
							>
								Star Lists → Filter Projects
							</h3>
						</div>
						<p
							class="text-xs text-primary/80 dark:text-primary/70 flex-1 leading-relaxed"
						>
							Jump to a curated repository list in the Projects tab. Selecting a
							list will auto‑filter the grid.
						</p>
						<Button
							data-open-projects
							size="sm"
							className="bg-primary hover:bg-primary/90 text-primary-foreground"
						>
							Open Projects
						</Button>
					</CardContent>
				</Card>
			</div>

			<!-- LeetCode Section -->
			<div id="leetcode-section" class="hidden space-y-8">
				<!-- Header Card (LeetCode) -->
				<Card className="relative border-border/60 bg-card/70 backdrop-blur">
					<CardContent className="p-4 sm:p-5">
						<!-- Mobile Layout -->
						<div class="flex flex-col gap-3 md:hidden">
							<div class="flex items-center gap-3">
								<div
									class="p-2 rounded-xl bg-chart-2/15 text-chart-2 ring-1 ring-chart-2/30"
								>
									<Trophy className="w-4 h-4" />
								</div>
								<h2 class="text-lg font-semibold text-foreground">
									LeetCode Profile
								</h2>
							</div>
							<div class="flex flex-wrap gap-2 items-center">
								<Badge variant="secondary" className="text-xs">
									{totalSolved} Solved
								</Badge>
								<a
									href="https://leetcode.com/u/khan_tashif/"
									target="_blank"
									rel="noopener noreferrer"
									class="inline-flex items-center gap-1 px-2.5 py-1 text-xs font-medium rounded-lg bg-secondary text-secondary-foreground hover:bg-secondary/80 transition-colors"
								>
									<ExternalLink className="w-3 h-3" />
									Profile
								</a>
								<a
									href="/leetcode"
									class="ml-auto inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-semibold rounded-lg bg-chart-2/15 text-chart-2 border border-chart-2/30 hover:bg-chart-2/25 hover:border-chart-2/50 transition-all"
								>
									<ChevronRight className="w-3.5 h-3.5" />
									Full Page
								</a>
							</div>
						</div>
						<!-- Desktop Layout -->
						<div class="hidden md:flex items-center gap-4">
							<div
								class="p-2.5 rounded-xl bg-chart-2/15 text-chart-2 ring-1 ring-chart-2/30"
							>
								<Trophy className="w-5 h-5" />
							</div>
							<div class="flex-1">
								<h2 class="text-xl font-semibold text-foreground mb-1">
									LeetCode Profile
								</h2>
								<p class="text-sm text-muted-foreground">
									Progress, contests and achievement highlights.
								</p>
							</div>
							<div class="flex flex-wrap gap-2 items-center">
								<Badge variant="secondary" className="text-xs">
									{totalSolved} Solved
								</Badge>
								<a
									href="https://leetcode.com/u/khan_tashif/"
									target="_blank"
									rel="noopener noreferrer"
									class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium bg-secondary text-secondary-foreground hover:bg-secondary/80 transition-colors"
								>
									External Profile <ExternalLink size={12} />
								</a>
								<a
									href="/leetcode"
									class="ml-2 inline-flex items-center gap-1.5 px-4 py-1.5 text-xs font-semibold rounded-lg bg-chart-2/15 text-chart-2 border border-chart-2/30 hover:bg-chart-2/25 hover:border-chart-2/50 shadow-sm hover:shadow-chart-2/20 transition-all"
								>
									<ChevronRight className="w-3.5 h-3.5" />
									Full Page
								</a>
							</div>
						</div>
					</CardContent>
				</Card>

				<!-- Core Stats -->
				<LeetCodeStats />

				<!-- Secondary Panels -->
				<div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
					<!-- Contests Panel -->
					<LeetCodeContests />

					<!-- Badges Panel -->
					<LeetCodeBadges />
				</div>
			</div>

			<!-- Community Section -->
			<div id="community-section" class="hidden">
				<div class="mb-10">
					<h2
						class="text-4xl font-bold tracking-tight text-gray-900 dark:text-white mb-4"
					>
						Let's Connect
					</h2>
					<p class="text-lg text-gray-600 dark:text-gray-400 max-w-2xl">
						I'm always open to discussing new projects, creative ideas or
						opportunities to be part of your visions.
					</p>
				</div>

				<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-16">
					<!-- GitHub -->
					<a
						href="https://github.com/tashifkhan"
						target="_blank"
						rel="noopener noreferrer"
						class="group relative overflow-hidden rounded-3xl bg-gray-900 p-8 transition-all hover:scale-[1.02] hover:shadow-xl lg:col-span-2 aspect-[2/1] md:aspect-auto"
					>
						<div
							class="absolute inset-0 bg-gradient-to-br from-gray-800 to-black opacity-50"
						>
						</div>
						<div class="relative z-10 h-full flex flex-col justify-between">
							<div class="flex justify-between items-start">
								<div class="p-3 bg-white/10 rounded-2xl backdrop-blur-md">
									<Github className="w-8 h-8 text-white" />
								</div>
								<ExternalLink
									className="w-6 h-6 text-gray-500 group-hover:text-white transition-colors"
								/>
							</div>
							<div>
								<h3 class="text-2xl font-bold text-white mb-2">GitHub</h3>
								<p class="text-gray-400 font-medium">
									Check out my open source contributions and latest code.
								</p>
							</div>
						</div>
					</a>

					<!-- Twitter -->
					<a
						href="https://twitter.com/khan_tashif_"
						target="_blank"
						rel="noopener noreferrer"
						class="group relative overflow-hidden rounded-3xl bg-sky-500 p-8 transition-all hover:scale-[1.02] hover:shadow-xl lg:col-span-1"
					>
						<div
							class="absolute inset-0 bg-gradient-to-br from-sky-400 to-sky-600 opacity-90"
						>
						</div>
						<div class="absolute -right-4 -bottom-4 opacity-20 rotate-12">
							<Twitter className="w-32 h-32 text-white" />
						</div>
						<div class="relative z-10 h-full flex flex-col justify-between">
							<div class="p-3 bg-white/20 rounded-2xl w-fit backdrop-blur-md">
								<Twitter className="w-6 h-6 text-white" />
							</div>
							<div class="mt-8">
								<h3 class="text-xl font-bold text-white mb-1">Twitter</h3>
								<p class="text-sky-100 text-sm">Tech insights & updates</p>
							</div>
						</div>
					</a>

					<!-- LinkedIn -->
					<a
						href="https://www.linkedin.com/in/tashif-ahmad-khan-982304244/"
						target="_blank"
						rel="noopener noreferrer"
						class="group relative overflow-hidden rounded-3xl bg-[#0077b5] p-8 transition-all hover:scale-[1.02] hover:shadow-xl lg:col-span-1"
					>
						<div
							class="absolute inset-0 bg-gradient-to-br from-[#0077b5] to-[#005582] opacity-90"
						>
						</div>
						<div class="absolute -right-4 -bottom-4 opacity-20 rotate-12">
							<Linkedin className="w-32 h-32 text-white" />
						</div>
						<div class="relative z-10 h-full flex flex-col justify-between">
							<div class="p-3 bg-white/20 rounded-2xl w-fit backdrop-blur-md">
								<Linkedin className="w-6 h-6 text-white" />
							</div>
							<div class="mt-8">
								<h3 class="text-xl font-bold text-white mb-1">LinkedIn</h3>
								<p class="text-blue-100 text-sm">Professional network</p>
							</div>
						</div>
					</a>
				</div>

				<!-- Contact Me Form & Email CTA -->
				<div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
					<!-- Email Card -->
					<div
						class="relative overflow-hidden rounded-3xl bg-gradient-to-br from-orange-400 to-orange-600 p-8 text-white lg:col-span-1 hidden md:flex flex-col justify-center"
					>
						<div class="absolute inset-0 bg-black/5"></div>
						<div class="relative z-10">
							<div
								class="p-3 bg-white/20 rounded-2xl w-fit backdrop-blur-md mb-6"
							>
								<Mail className="w-8 h-8 text-white" />
							</div>
							<h3 class="text-2xl font-bold mb-4">Email Me</h3>
							<p class="text-orange-100 mb-8 leading-relaxed">
								Prefer email? Send me a direct message and I'll get back to you
								as soon as possible.
							</p>
							<a
								href="mailto:tashif@duck.com"
								class="inline-flex items-center justify-center w-full px-6 py-3 bg-white text-orange-600 font-bold rounded-xl hover:bg-orange-50 transition-colors"
							>
								Send Email
							</a>
						</div>
					</div>

					<!-- Form -->
					<Card
						className="lg:col-span-2 border-0 shadow-lg bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl"
					>
						<CardContent className="p-8">
							<div class="mb-6">
								<h3
									class="text-2xl font-bold text-gray-900 dark:text-white mb-2"
								>
									Send a Message
								</h3>
								<p class="text-gray-500 dark:text-gray-400">
									Drop a quick note below.
								</p>
							</div>
							<form id="contact-form" class="space-y-6" autocomplete="on">
								<div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
									<div class="space-y-2">
										<Label
											htmlFor="contact-name"
											className="text-sm font-medium text-gray-700 dark:text-gray-300"
											>Name</Label
										>
										<Input
											id="contact-name"
											name="name"
											type="text"
											placeholder="Your name"
											className="h-11 rounded-xl bg-gray-50 dark:bg-gray-800/50 border-gray-200 dark:border-gray-700 focus:ring-2 focus:ring-primary/20"
										/>
									</div>
									<div class="space-y-2">
										<Label
											htmlFor="contact-email"
											className="text-sm font-medium text-gray-700 dark:text-gray-300"
											>Email</Label
										>
										<Input
											id="contact-email"
											name="email"
											type="email"
											required
											placeholder="you@example.com"
											className="h-11 rounded-xl bg-gray-50 dark:bg-gray-800/50 border-gray-200 dark:border-gray-700 focus:ring-2 focus:ring-primary/20"
										/>
									</div>
								</div>
								<div class="space-y-2">
									<Label
										htmlFor="contact-subject"
										className="text-sm font-medium text-gray-700 dark:text-gray-300"
										>Subject</Label
									>
									<Input
										id="contact-subject"
										name="subject"
										type="text"
										placeholder="What's this about?"
										className="h-11 rounded-xl bg-gray-50 dark:bg-gray-800/50 border-gray-200 dark:border-gray-700 focus:ring-2 focus:ring-primary/20"
									/>
								</div>
								<div class="space-y-2">
									<Label
										htmlFor="contact-message"
										className="text-sm font-medium text-gray-700 dark:text-gray-300"
										>Message</Label
									>
									<Textarea
										id="contact-message"
										name="message"
										required
										rows={5}
										placeholder="Write your message here..."
										className="resize-y rounded-xl bg-gray-50 dark:bg-gray-800/50 border-gray-200 dark:border-gray-700 focus:ring-2 focus:ring-primary/20 p-4"
									/>
								</div>
								<div class="flex justify-end">
									<Button
										type="submit"
										size="lg"
										className="rounded-xl px-8 bg-primary hover:bg-primary/90 text-white shadow-lg shadow-primary/25"
									>
										Send Message
									</Button>
								</div>
							</form>
						</CardContent>
					</Card>
				</div>
			</div>
		</main>
	</div>
</Layout>

<!-- Scroll to top button -->
<Button
	id="scroll-top-btn"
	type="button"
	size="icon"
	className="fixed bottom-6 right-6 z-40 h-11 w-11 rounded-full shadow-md opacity-0 pointer-events-none transition-all"
	aria-label="Scroll to top"
>
	<ArrowUp size={18} />
</Button>

<script>
	// Tab switching logic
	const tabs = {
		projects: document.getElementById("projects-tab"),
		resume: document.getElementById("resume-tab"),
		blog: document.getElementById("blog-tab"),
		github: document.getElementById("github-tab"),
		leetcode: document.getElementById("leetcode-tab"),
		community: document.getElementById("community-tab"),
	};

	const sections = {
		projects: document.getElementById("projects-section"),
		resume: document.getElementById("resume-section"),
		blog: document.getElementById("blog-section"),
		github: document.getElementById("github-section"),
		leetcode: document.getElementById("leetcode-section"),
		community: document.getElementById("community-section"),
	};

	function activateTab(
		tabId: "projects" | "blog" | "leetcode" | "github" | "resume" | "community"
	) {
		Object.entries(tabs).forEach(([key, tab]) => {
			if (!tab) return;
			tab.setAttribute("data-state", "inactive");
		});

		const activeTab = tabs[tabId];
		if (activeTab) {
			activeTab.setAttribute("data-state", "active");
		}

		Object.values(sections).forEach((section) => {
			if (!section) return;
			section.classList.add("hidden");
		});

		const activeSection = sections[tabId];
		if (activeSection) {
			activeSection.classList.remove("hidden");
		}
	}

	tabs.projects?.addEventListener("click", () => activateTab("projects"));
	tabs.blog?.addEventListener("click", () => activateTab("blog"));
	tabs.leetcode?.addEventListener("click", () => activateTab("leetcode"));
	tabs.github?.addEventListener("click", () => activateTab("github"));
	tabs.resume?.addEventListener("click", () => activateTab("resume"));
	tabs.community?.addEventListener("click", () => activateTab("community"));

	// Enhanced search functions
	function fuzzySearch(text: string, query: string): boolean {
		if (!query.trim()) return true;

		const textLower = text.toLowerCase();
		const queryLower = query.toLowerCase();

		// Exact match check
		if (textLower.includes(queryLower)) return true;

		// Fuzzy match using character sequence
		let queryIndex = 0;
		for (
			let i = 0;
			i < textLower.length && queryIndex < queryLower.length;
			i++
		) {
			if (textLower[i] === queryLower[queryIndex]) {
				queryIndex++;
			}
		}

		// If we found all characters in sequence, it's a fuzzy match
		return queryIndex === queryLower.length;
	}

	function enhancedSearch(
		text: string,
		query: string,
		exactOnly: boolean
	): boolean {
		if (!query.trim()) return true;

		const textLower = text.toLowerCase();
		const queryLower = query.toLowerCase();

		console.log(`Enhanced search: "${text}" vs "${query}"`);

		// 1. Exact substring match (highest priority)
		if (textLower.includes(queryLower)) {
			console.log("  -> Exact match found");
			return true;
		}

		// If exactOnly flag, skip deeper fuzzy logic
		if (exactOnly) return false;

		// 2. Word boundary match (matches whole words)
		const words = textLower.split(/\s+/);
		const queryWords = queryLower.split(/\s+/);

		// Check if all query words are found in text words
		const allWordsFound = queryWords.every((queryWord) =>
			words.some((word) => word.includes(queryWord))
		);
		if (allWordsFound) {
			console.log("  -> Word boundary match found");
			return true;
		}

		// 3. Fuzzy match (for typos and partial matches)
		const fuzzyResult = fuzzySearch(textLower, queryLower);
		console.log("  -> Fuzzy match result:", fuzzyResult);
		return fuzzyResult;
	}

	// Project search and filter functionality (exact matches first, then fuzzy)
	document.addEventListener("project-search", (e: Event) => {
		const { term: searchTerm, showLiveOnly, list } = (e as CustomEvent).detail;
		const query = (searchTerm || "").trim().toLowerCase();
		const projectCards = Array.from(
			document.querySelectorAll("[data-project-item-card]")
		);
		let liveProjectCount = 0;
		const exactMatches: HTMLElement[] = [];
		const fuzzyMatches: HTMLElement[] = [];

		projectCards.forEach((cardEl, index) => {
			const card = cardEl as HTMLElement;
			const title =
				card.querySelector("[data-project-title]")?.textContent || "";
			const description =
				card.querySelector("[data-project-description]")?.textContent || "";
			const languages = Array.from(
				card.querySelectorAll("[data-project-language]")
			).map((l) => l.textContent || "");
			const fields = [title, description, ...languages].map((f) =>
				f.toLowerCase()
			);
			const hasLiveLink =
				card.querySelector("[data-live-link]") !== null ||
				card.getAttribute("data-has-live-link") === "true";
			if (hasLiveLink) liveProjectCount++;

			// Star list filtering
			let listFilter = true;
			if (list && list !== "all-projects") {
				const repoName = card
					.querySelector("[data-github-link]")
					?.getAttribute("data-url")
					?.split("/")
					?.pop();
				// @ts-ignore
				const starLists = window.__STAR_LISTS__ as
					| { name: string; repositories?: string[] }[]
					| undefined;
				const selected = starLists?.find((l) => l.name === list);
				const repoNames = (selected?.repositories || []).map((r) =>
					r.split("/").pop()
				);
				listFilter = repoName ? repoNames.includes(repoName) : false;
			}

			let isExact = false;
			let isFuzzy = false;
			if (!query) {
				isExact = true; // treat empty query as exact so we skip reordering
			} else {
				isExact = fields.some((f) => f.includes(query));
				if (!isExact) {
					isFuzzy = fields.some((f) => fuzzySearch(f, query));
				}
			}

			const liveFilter = !showLiveOnly || hasLiveLink;
			const matches = (isExact || isFuzzy) && liveFilter && listFilter;
			card.style.display = matches ? "" : "none";

			if (matches) {
				if (isExact) exactMatches.push(card);
				else if (isFuzzy) fuzzyMatches.push(card);
			}
		});

		// Re-order DOM for non-empty queries: exact first then fuzzy
		if (query && projectCards.length) {
			const gridContainer = (projectCards[0] as HTMLElement).parentElement;
			if (gridContainer) {
				const frag = document.createDocumentFragment();
				exactMatches.forEach((card) => frag.appendChild(card));
				fuzzyMatches.forEach((card) => frag.appendChild(card));
				gridContainer.appendChild(frag);
			}
		}
	});

	// When a starred list is requested from GitHub section
	document.addEventListener("open-star-list", (e: Event) => {
		const name = (e as CustomEvent).detail?.name as string | undefined;
		if (!name) return;
		activateTab("projects");
		// store temporarily for ProjectFilters hydration listener
		localStorage.setItem("pending_star_list_select", name);
		// Attempt to update select if already mounted
		setTimeout(() => {
			const select = document.querySelector(
				"[data-project-list-select]"
			) as HTMLSelectElement | null;
			if (select) {
				select.value = name;
				select.dispatchEvent(new Event("change", { bubbles: true }));
			}
		}, 80);
	});

	// Blog search and filter functionality (title + tags)
	document.addEventListener("blog-search", (e: Event) => {
		const searchTerm = (e as CustomEvent).detail.term;
		const blogCards = document.querySelectorAll("[data-blog-card]");

		console.log("Blog search triggered with term:", searchTerm);
		console.log("Found blog cards:", blogCards.length);

		blogCards.forEach((card, index) => {
			const title = card.querySelector("[data-blog-title]")?.textContent || "";
			const tags = Array.from(card.querySelectorAll("[data-blog-tag]")).map(
				(el) => el.textContent || ""
			);

			console.log(
				`Card ${index}: title="${title}", tags=${JSON.stringify(tags)}`
			);

			// Use enhanced search for better matching
			const titleMatch = enhancedSearch(title, searchTerm, false);
			const tagMatch = tags.some((t) => enhancedSearch(t, searchTerm, false));

			const matches = titleMatch || tagMatch;
			console.log(
				`Card ${index} matches: ${matches} (titleMatch: ${titleMatch}, tagMatch: ${tagMatch})`
			);

			(card as HTMLElement).style.display = matches ? "block" : "none";
		});
	});

	document.addEventListener("blog-category", (e: Event) => {
		const categories = (e as CustomEvent).detail.categories as string[];
		const blogCards = document.querySelectorAll("[data-blog-card]");

		console.log("Blog category filter triggered with categories:", categories);
		console.log("Found blog cards:", blogCards.length);

		blogCards.forEach((card, index) => {
			const tags = (card.getAttribute("data-blog-tags") || "")
				.split(",")
				.filter(Boolean);

			// Match if "all" is selected OR if any of the selected categories matches any of the post's tags
			const matches =
				categories.includes("all") ||
				categories.some((cat) => tags.includes(cat));

			console.log(
				`Card ${index}: tags=${JSON.stringify(tags)}, matches: ${matches}`
			);

			(card as HTMLElement).style.display = matches ? "block" : "none";
		});
	});

	// Initialize filters and handle link clicks
	document.addEventListener("DOMContentLoaded", () => {
		const theme = localStorage.getItem("theme") || "dark";
		document.documentElement.classList.toggle("dark", theme === "dark");

		// Initialize project filters with default state
		const projectCards = document.querySelectorAll("[data-project-item-card]");
		console.log(
			"Initializing project filters with",
			projectCards.length,
			"cards"
		);

		// Count live projects for debugging
		let liveProjectCount = 0;
		projectCards.forEach((card) => {
			const hasLiveLink =
				card.querySelector("[data-live-link]") !== null ||
				card.getAttribute("data-has-live-link") === "true";
			if (hasLiveLink) liveProjectCount++;
		});
		console.log("Total live projects found:", liveProjectCount);

		// Apply initial filter state (show all projects by default)
		const initialSearchEvent = new CustomEvent("project-search", {
			detail: { term: "", showLiveOnly: false },
		});
		document.dispatchEvent(initialSearchEvent);

		// Scroll-to-top button visibility
		const WELCOME_KEY = "welcome_hidden";
		const welcomeBanner = document.getElementById("welcome-banner");
		const welcomeDismiss = document.getElementById("welcome-dismiss");
		const welcomeRestore = document.getElementById("welcome-restore");
		const welcomeRestoreBtn = document.getElementById("welcome-restore-btn");

		const isMobile = () => window.innerWidth < 768;

		const applyWelcomeState = (hidden: boolean) => {
			if (!welcomeBanner || !welcomeRestore) return;

			// On mobile, hide both banner and restore pill entirely
			if (isMobile()) {
				welcomeBanner.classList.add("hidden");
				welcomeRestore.classList.add("hidden");
				return;
			}

			// On desktop, use the stored preference
			welcomeBanner.classList.toggle("hidden", hidden);
			welcomeRestore.classList.toggle("hidden", !hidden);
		};

		const storedHidden = localStorage.getItem(WELCOME_KEY) === "1";
		applyWelcomeState(storedHidden);

		// Re-apply state on window resize
		window.addEventListener("resize", () => {
			const storedHidden = localStorage.getItem(WELCOME_KEY) === "1";
			applyWelcomeState(storedHidden);
		});

		welcomeDismiss?.addEventListener("click", () => {
			localStorage.setItem(WELCOME_KEY, "1");
			applyWelcomeState(true);
		});

		welcomeRestoreBtn?.addEventListener("click", () => {
			localStorage.removeItem(WELCOME_KEY);
			applyWelcomeState(false);
		});

		// Default to projects tab on load
		activateTab("projects");

		// Scroll-to-top button visibility
		const scrollBtn = document.getElementById("scroll-top-btn");
		if (scrollBtn) {
			const onScroll = () => {
				const show = window.scrollY > 400;
				scrollBtn.classList.toggle("opacity-100", show);
				scrollBtn.classList.toggle("pointer-events-auto", show);
				scrollBtn.classList.toggle("opacity-0", !show);
				scrollBtn.classList.toggle("pointer-events-none", !show);
			};
			window.addEventListener("scroll", onScroll, { passive: true });
			onScroll();
			scrollBtn.addEventListener("click", () => {
				window.scrollTo({ top: 0, behavior: "smooth" });
			});
		}

		// Contact form mailto handler
		const contactForm = document.getElementById(
			"contact-form"
		) as HTMLFormElement | null;
		if (contactForm) {
			contactForm.addEventListener("submit", (e) => {
				e.preventDefault();
				const name =
					(
						document.getElementById("contact-name") as HTMLInputElement | null
					)?.value.trim() || "";
				const email =
					(
						document.getElementById("contact-email") as HTMLInputElement | null
					)?.value.trim() || "";
				const subjectRaw =
					(
						document.getElementById(
							"contact-subject"
						) as HTMLInputElement | null
					)?.value.trim() || "";
				const messageRaw =
					(
						document.getElementById(
							"contact-message"
						) as HTMLTextAreaElement | null
					)?.value.trim() || "";
				const statusEl = document.getElementById("contact-status");

				if (!email || !messageRaw) {
					if (statusEl) statusEl.textContent = "Email & message are required.";
					return;
				}

				// Basic email heuristic
				if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
					if (statusEl)
						statusEl.textContent = "Please provide a valid email address.";
					return;
				}

				const subject =
					subjectRaw || `Message from ${name || "Website Visitor"}`;
				const bodyLines = [
					`Name: ${name || "(not provided)"}`,
					`Email: ${email}`,
					"",
					messageRaw,
					"",
					"---",
					"Sent via dashboard contact form",
				];
				const body = encodeURIComponent(bodyLines.join("\n"));
				const mailto = `mailto:tashif@duck.com?subject=${encodeURIComponent(subject)}&body=${body}`;

				if (statusEl) statusEl.textContent = "Opening your email client...";
				window.location.href = mailto;
			});
		}
	});
</script>
